# ‚úÖ –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ - 1plat Payment Integration

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 1plat
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∏
- API endpoint –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- Webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã

### ‚úÖ Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ö—Ä–∞—Å–∏–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
- –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ (–∫–∞—Ä—Ç–∞/–°–ë–ü)
- –°—Ç—Ä–∞–Ω–∏—Ü—ã success/failure —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º–∏
- –£–±—Ä–∞–Ω–∞ –∑–∞–≥–ª—É—à–∫–∞ —Å –∫–æ–¥–æ–º "1234"

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- TypeScript: ‚úì –ë–µ–∑ –æ—à–∏–±–æ–∫
- Build: ‚úì –£—Å–ø–µ—à–Ω–æ
- Dev server: ‚úì –ó–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ /song: ‚úì –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–°–ï–ô–ß–ê–°)
```bash
# –°–µ—Ä–≤–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3000
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/song
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É
3. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–ª—É—á–∏—Ç—å –≥–æ—Ç–æ–≤—É—é –ø–µ—Å–Ω—é"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ü–µ–Ω–∞ 590‚ÇΩ

### 2. Git & GitHub
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
git status

# –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .

# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–º–∏—Ç
git commit -m "feat: Add 1plat payment integration

- Implemented 1plat provider with signature verification
- Created payment modal with card/SBP selection
- Added webhook handler with auto-generation trigger
- Updated success/failure pages with auto-redirect
- Removed mock payment with code '1234'
- Price set to 145‚ÇΩ (displayed as 590‚ÇΩ with discount)"

# –û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞ GitHub
git push origin main
```

### 3. Vercel Deployment

–ü–æ—Å–ª–µ `git push`, Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω—ë—Ç –¥–µ–ø–ª–æ–π.

**–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel:**

```
ONEPLAT_SHOP_ID=1296
ONEPLAT_SECRET=Kogortalove1!
NEXT_PUBLIC_APP_URL=https://yourdomain.com  ‚Üê –í–ê–®–ï_–î–û–ú–ï–ù
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ 1plat (–ü–û–°–õ–ï –¥–µ–ø–ª–æ—è)

–ó–∞–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç 1plat –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:

1. **Webhook URL:**
   ```
   https://yourdomain.com/api/payment/1plat/webhook
   ```

2. **Success URL:**
   ```
   https://yourdomain.com/payment/success
   ```

3. **Failure URL:**
   ```
   https://yourdomain.com/payment/failure
   ```

4. **–í–∫–ª—é—á–∏—Ç–µ 2FA** –¥–ª—è –∑–∞—â–∏—Ç—ã –∞–∫–∫–∞—É–Ω—Ç–∞

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Production

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∞—à —Å–∞–π—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –æ–ø–ª–∞—Ç—É (–º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - Webhook –ø–æ–ª—É—á–µ–Ω (Vercel Logs)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å
   - –ó–∞–∫–∞–∑ –≤ –ë–î –æ–±–Ω–æ–≤–ª—ë–Ω

## üìÇ –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ/–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
lib/payment/
  ‚îú‚îÄ‚îÄ config.ts                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  ‚îú‚îÄ‚îÄ types.ts                           # –¢–∏–ø—ã
  ‚îî‚îÄ‚îÄ providers/oneplat.ts               # –ü—Ä–æ–≤–∞–π–¥–µ—Ä 1plat

app/api/payment/
  ‚îú‚îÄ‚îÄ create/route.ts                    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
  ‚îî‚îÄ‚îÄ 1plat/webhook/route.ts             # Webhook handler

app/(services)/song/components/
  ‚îú‚îÄ‚îÄ PaymentModal.tsx                   # –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
  ‚îî‚îÄ‚îÄ GenerationFlow.tsx                 # –û–±–Ω–æ–≤–ª—ë–Ω (—É–±—Ä–∞–Ω–∞ –∑–∞–≥–ª—É—à–∫–∞)

app/payment/
  ‚îú‚îÄ‚îÄ success/page.tsx                   # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
  ‚îî‚îÄ‚îÄ failure/page.tsx                   # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—à–∏–±–∫–∏

docs/
  ‚îú‚îÄ‚îÄ 1plat-api.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
  ‚îú‚îÄ‚îÄ PAYMENT_INTEGRATION.md             # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  ‚îî‚îÄ‚îÄ DEPLOYMENT_CHECKLIST.md            # –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è

public/
  ‚îî‚îÄ‚îÄ 1plat.txt                          # –§–∞–π–ª –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (1296)

.env.local                               # –û–±–Ω–æ–≤–ª–µ–Ω—ã credentials
```

## üìä –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

### –ü–ª–∞—Ç–µ–∂–∏:
1. **1plat –õ–ö**: https://1plat.cash ‚Üí –†–∞–∑–¥–µ–ª "–ü–ª–∞—Ç–µ–∂–∏"
2. **Supabase**: Table Editor ‚Üí orders (—Ñ–∏–ª—å—Ç—Ä `payment_provider = '1plat'`)
3. **Vercel Logs**: –ü–æ–∏—Å–∫ –ø–æ `[1plat Webhook]` –∏–ª–∏ `[Payment]`

### SQL –¥–ª—è Supabase:
```sql
SELECT
  id,
  created_at,
  customer_email,
  status,
  payment_id,
  amount
FROM orders
WHERE payment_provider = '1plat'
ORDER BY created_at DESC;
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¶–µ–Ω–∞**: 145‚ÇΩ (–≤ `lib/payment/config.ts`)
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ 590‚ÇΩ —Å–æ —Å–∫–∏–¥–∫–æ–π 50%
   - –ò–∑–º–µ–Ω–∏—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

2. **NEXT_PUBLIC_APP_URL**:
   - –õ–æ–∫–∞–ª—å–Ω–æ: `http://localhost:3000`
   - Production: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ–±–Ω–æ–≤–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –¥–æ–º–µ–Ω!

3. **Webhook security**:
   - –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å—å
   - –ù–µ –æ—Ç–∫–ª—é—á–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É

4. **2FA –≤ 1plat**:
   - –ù–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
   - Google Authenticator –∏–ª–∏ Authy

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é. –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã:

- ‚úÖ –ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Build –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ
- ‚úÖ Dev —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è –≥–æ—Ç–æ–≤

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ, –∑–∞—Ç–µ–º –¥–µ–ø–ª–æ–π—Ç–µ!

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docs/DEPLOYMENT_CHECKLIST.md`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Vercel
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ 1plat –õ–ö
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É 1plat –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**Good luck! üöÄ**
