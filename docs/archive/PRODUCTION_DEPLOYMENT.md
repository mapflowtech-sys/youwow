# –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º –ÆKassa

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏

### 1. –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa (https://yookassa.ru)

- [ ] **–ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞** - –º–∞–≥–∞–∑–∏–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–æ–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
- [ ] **Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω:**
  - URL: `https://youwow.ru/api/payment/yookassa/webhook`
  - –°–æ–±—ã—Ç–∏—è: `payment.succeeded`, `payment.canceled`
  - HTTP –º–µ—Ç–æ–¥: POST
  - –í–µ—Ä—Å–∏—è API: latest
- [ ] **–ë–æ–µ–≤—ã–µ –∫–ª—é—á–∏ –ø–æ–ª—É—á–µ–Ω—ã:**
  - Shop ID: `1229933` (—É–∂–µ –µ—Å—Ç—å –≤ .env.local)
  - Secret Key: `live_4mvUbA8fN9DWepS5Z_3qPAfNX1q6osihl6LYqbvTYy8` (—É–∂–µ –µ—Å—Ç—å)

### 2. –í Vercel (Environment Variables)

–ó–∞–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –±–æ–µ–≤—ã–µ:

```bash
# Production YooKassa
YOOKASSA_SHOP_ID=1229933
YOOKASSA_SECRET_KEY=live_4mvUbA8fN9DWepS5Z_3qPAfNX1q6osihl6LYqbvTYy8
PAYMENT_PROVIDER=yookassa

# Optional: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–≤ –∫–æ–ø–µ–π–∫–∞—Ö, 100 = 1‚ÇΩ)
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:
# YOOKASSA_MIN_TEST_PRICE=100
```

**–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞—Ç—å Redeploy –≤ Vercel!

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

#### –¢–µ—Å—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π (1‚ÇΩ):

1. –í—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ Vercel –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   ```
   YOOKASSA_MIN_TEST_PRICE=100
   ```
2. –°–¥–µ–ª–∞—Ç—å Redeploy
3. –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ —Å–∞–π—Ç–µ
4. –û–ø–ª–∞—Ç–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–æ–π 1‚ÇΩ
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å
6. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —É–±—Ä–∞—Ç—å `YOOKASSA_MIN_TEST_PRICE` –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É

#### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ÆKassa (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤):

**–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞:**
- –ù–æ–º–µ—Ä: `5555 5555 5555 4477`
- –°—Ä–æ–∫: –ª—é–±–æ–π –±—É–¥—É—â–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 12/25)
- CVC: –ª—é–±–æ–π (123)
- 3-D Secure –∫–æ–¥: `123` (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

**–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã:**
- –ù–æ–º–µ—Ä: `5555 5555 5555 5599`
- (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ –∂–µ)

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—Ö–æ–¥–∞ (–ø–æ—à–∞–≥–æ–≤–æ)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ú—è–≥–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π

```bash
# –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –≤ Vercel –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
YOOKASSA_SHOP_ID=1229933
YOOKASSA_SECRET_KEY=live_4mvUbA8fN9DWepS5Z_3qPAfNX1q6osihl6LYqbvTYy8
YOOKASSA_MIN_TEST_PRICE=100  # 1‚ÇΩ –¥–ª—è —Ç–µ—Å—Ç–∞

# –®–∞–≥ 2: Redeploy –≤ Vercel

# –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É 1‚ÇΩ –Ω–∞ production

# –®–∞–≥ 4: –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç - —É–±—Ä–∞—Ç—å YOOKASSA_MIN_TEST_PRICE
# –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10000 = 100‚ÇΩ)

# –®–∞–≥ 5: –°–Ω–æ–≤–∞ Redeploy
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º

```bash
# –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –≤ Vercel –¢–û–õ–¨–ö–û –±–æ–µ–≤—ã–µ –∫–ª—é—á–∏
YOOKASSA_SHOP_ID=1229933
YOOKASSA_SECRET_KEY=live_4mvUbA8fN9DWepS5Z_3qPAfNX1q6osihl6LYqbvTYy8

# –®–∞–≥ 2: Redeploy –≤ Vercel

# –¶–µ–Ω–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è 590‚ÇΩ (–∫–∞–∫ –≤ –∫–æ–¥–µ)
```

---

## üß™ –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –¥–ª—è —Ç–µ—Å—Ç–æ–≤

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ü–µ–Ω–æ–π 1‚ÇΩ –∏–ª–∏ 10‚ÇΩ, —è –º–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `YOOKASSA_MIN_TEST_PRICE` –≤ –∫–æ–¥.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
```typescript
// –í app/api/payment/create/route.ts
const basePrice = 590; // —Ä—É–±–ª–∏
const testPrice = process.env.YOOKASSA_MIN_TEST_PRICE
  ? parseInt(process.env.YOOKASSA_MIN_TEST_PRICE) / 100
  : null;

const finalPrice = testPrice || basePrice;
```

–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –¥–æ–±–∞–≤–∏–ª —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å?

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **Webhook –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–ª—è –±–æ–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ - –±–µ–∑ –Ω–µ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
2. **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –±–æ–µ–≤–æ–º —Ä–µ–∂–∏–º–µ** - –Ω—É–∂–Ω–∞ —Ä–µ–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞
3. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ÆKassa** - 1‚ÇΩ (100 –∫–æ–ø–µ–µ–∫)
4. **–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ Redeploy –≤ Vercel
5. **–ü–µ—Ä–≤—É—é –æ–ø–ª–∞—Ç—É –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º | –ë–æ–µ–≤–æ–π —Ä–µ–∂–∏–º |
|----------|----------------|--------------|
| Shop ID | `1238710` | `1229933` |
| Secret Key | `test_dT9Y...` | `live_4mvU...` |
| –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç |
| –†–µ–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç |
| –î–µ–Ω—å–≥–∏ —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| Webhook | ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª–µ–Ω |
| –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ | –õ—é–±–∞—è | 1‚ÇΩ (100 –∫–æ–ø–µ–µ–∫) |

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. ‚úÖ **–°–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –≤ –ÆKassa
2. ‚úÖ **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —Ç–µ—Å—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã** (—è –º–æ–≥—É —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å)
3. ‚úÖ **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –±–æ–µ–≤—ã–µ –∫–ª—é—á–∏ –≤ Vercel** —Å —Ü–µ–Ω–æ–π 1‚ÇΩ
4. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –æ–ø–ª–∞—Ç—É** 1‚ÇΩ
5. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å**
6. ‚úÖ **–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook —Å—Ä–∞–±–æ—Ç–∞–ª** (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Vercel)
7. ‚úÖ **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É** (590‚ÇΩ –∏–ª–∏ –¥—Ä—É–≥—É—é)
8. ‚úÖ **–§–∏–Ω–∞–ª—å–Ω—ã–π Redeploy**

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 30.12.2025
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ production
